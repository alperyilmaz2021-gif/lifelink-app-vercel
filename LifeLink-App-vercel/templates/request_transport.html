{% extends "_base.html" %}{% block content %}
<div class="container section">
  <h2 class="h2">Request Transport</h2>
  <p class="sub">Confirm details and place a delivery request for this organ.</p>

  <div class="card" style="margin-bottom:18px">
    <div class="row" style="grid-template-columns:1fr 1fr">
      <div>
        <div class="pill">{{ listing.organ_type }}</div>
        <h3 style="margin:4px 0 2px">{{ listing.hospital_name }}</h3>
        <div class="small">{{ listing.city }}, {{ listing.state }}</div>
        <div class="small">Blood type: <b>{{ listing.blood_type }}</b></div>
      </div>
      <div class="small" style="text-align:right">
        <div>Priority: <b>{{ listing.priority_status or 'Normal' }}</b></div>
        <div>Availability:
          {% if listing.availability_status == 'Available' %}
            <b style="color:#28a745">Available</b>
          {% else %}
            <b style="color:#e55353">Unavailable</b>
          {% endif %}
        </div>
        <div>Age: {{ listing.age }} years</div>
        <div>Weight: {{ "%.1f"|format(listing.weight_kg or 0) }} kg</div>
      </div>
    </div>
    <div class="small" style="margin-top:8px">
      <b>Pick-up location:</b> {{ listing.hospital_name }} ({{ listing.city }}, {{ listing.state }})
    </div>
  </div>

  <form class="card form" method="post">
    <b>Delivery Details</b>
    <div class="grid-2">
      <div>
        <label class="small">Requesting Hospital</label>
        <select name="hospital_id" required>
          <option value="">Select hospital...</option>
          {% for h in hospitals %}
            <option value="{{ h.id }}" {% if listing.hospital_name == h.name %}selected{% endif %}>
              {{ h.name }} ({{ h.city }}, {{ h.state }})
            </option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label class="small">Delivery Address</label>
        <input name="destination" placeholder="Destination address / receiving hospital" required>
      </div>
    </div>
    <div class="grid-2" style="margin-top:8px">
      <div>
        <label class="small">Contact phone</label>
        <input name="contact_phone" placeholder="+1-555-000-0000" required>
      </div>
      <div></div>
    </div>
    <textarea name="notes" rows="3" placeholder="Clinical notes or special handling instructions (optional)" style="margin-top:8px"></textarea>
    <div style="margin-top:12px;display:flex;gap:12px">
      <button class="btn primary" type="submit">Place Request</button>
      <a class="btn" href="{{ url_for('organ_listings') }}">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
